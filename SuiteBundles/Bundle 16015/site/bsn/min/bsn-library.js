var GPR_AAE_BSN=function(B){var A={checkChildQtyURL:"/app/site/hosting/scriptlet.nl?script=customscript_gpr_aae_ss_bsn_chkchildqty&deploy=customdeploy_gpr_aae_ss_bsn_chkchildqty",checkQtyURL:"/app/site/hosting/scriptlet.nl?script=customscript_gpr_aae_ss_bsn_chkqty&deploy=customdeploy_gpr_aae_ss_bsn_chkqty",saveFormURL:"",showInfoCntId:"bsn_info",formLinkId:"bsn_save_link",formIframeId:"bsn_save_iframe",containerId:"bsn_save"};
return{init:function(C){if(C!==null&&C!==undefined){B.extend(A,C)}},setOptionsEvent:function(){B("select[id^='custcol']").change(function(){GPR_AAE_BSN.checkChildQty()})},checkQty:function(){B("#"+A.formIframeId).hide();var C={parentid:A.itemId};B.ajax({url:A.checkQtyURL,type:"GET",dataType:"jsonp",data:C,success:function(D){if(D.Errors.length>0){B.each(D.Errors,function(E,F){GPR_AJAX_TOOLS.showError(A.showInfoCntId,"Check Stock",F.code,F.details);
B("#"+A.containerId).hide()})}else{if(D.Results.matrix){GPR_AAE_BSN.setOptionsEvent()}else{if(D.Results.available){B("#"+A.containerId).hide()}else{B("#"+A.formIframeId).attr("src",A.saveFormURL+"&custrecord_gpr_aae_bsn_itemid="+A.itemId+"&custrecord_gpr_aae_bsn_customerid="+GPR_OPTIONS.options().customerId+"&custrecord_gpr_aae_bsn_sitenumber="+GPR_OPTIONS.options().siteNumber);
B("#"+A.formLinkId).attr("href",A.saveFormURL+"&custrecord_gpr_aae_bsn_itemid="+A.itemId+"&custrecord_gpr_aae_bsn_customerid="+GPR_OPTIONS.options().customerId+"&custrecord_gpr_aae_bsn_sitenumber="+GPR_OPTIONS.options().siteNumber);B("#"+A.containerId).show()}}}},beforeSend:function(D){GPR_AJAX_TOOLS.startLoading(A.showInfoCntId,"Checking Stock...")},complete:function(D,E){GPR_AJAX_TOOLS.stopLoading(A.showInfoCntId)
},error:function(D,F,E){GPR_AJAX_TOOLS.showError(A.showInfoCntId,"Check Stock",F,E)}})},checkChildQty:function(){B("#"+A.formIframeId).hide();var C=[];var E=true;B("select[id^='custcol'] option:selected").each(function(){if(B(this).val()!=""){C.push(B(this).text())}else{E=false}});if(E){var D;var F={parentid:A.itemId,itemoptions:GPR_TOOLS.uncode(C.join("|"))};
B.ajax({url:A.checkChildQtyURL,type:"GET",dataType:"jsonp",data:F,success:function(G){if(G.Errors.length>0){$j.each(G.Errors,function(H,I){GPR_AJAX_TOOLS.showError(A.showInfoCntId,"Check Child Stock",I.code,I.details);B("#"+A.containerId).hide()})}else{if(G.Results.available){B("#"+A.containerId).hide()}else{B("#"+A.formIframeId).attr("src",A.saveFormURL+"&custrecord_gpr_aae_bsn_itemid="+A.itemId+"&custrecord_gpr_aae_bsn_childid="+G.Results.childid+"&custrecord_gpr_aae_bsn_customerid="+GPR_OPTIONS.options().customerId+"&custrecord_gpr_aae_bsn_sitenumber="+GPR_OPTIONS.options().siteNumber);
B("#"+A.formLinkId).attr("href",A.saveFormURL+"&custrecord_gpr_aae_bsn_itemid="+A.itemId+"&custrecord_gpr_aae_bsn_childid="+A.childid+"&custrecord_gpr_aae_bsn_customerid="+GPR_OPTIONS.options().customerId+"&custrecord_gpr_aae_bsn_sitenumber="+GPR_OPTIONS.options().siteNumber);B("#"+A.containerId).show()}}},beforeSend:function(G){GPR_AJAX_TOOLS.startLoading(A.showInfoCntId,"Checking Child Stock...")
},complete:function(G,H){GPR_AJAX_TOOLS.stopLoading(A.showInfoCntId)},error:function(G,I,H){GPR_AJAX_TOOLS.showError(A.showInfoCntId,"Check Child Stock",I,H)}})}},showForm:function(){if(B("#"+A.formIframeId).is(":hidden")){B("#"+A.formIframeId).show()}else{B("#"+A.formIframeId).hide()}}}}(jQuery);