<% var view_credit_card = view.creditcard %>

<% if (view_credit_card && !view_credit_card.isNew()) { %>
	<div id="creditcard-module-list-placeholder" class="creditcard-module-list-placeholder">
		<!--<p>
			<a class="btn btn-link" href="/creditcards/new" data-toggle="show-in-modal">
				<%= _('Add New Credit Card').translate() %>
			</a>
		</p>-->
		<%
			var creditcardWrap = function (creditcard) {
				return SC.macros.creditcard(creditcard, {
					showSelect: true
				,	showActions: true
				,	showDefaults: false
				,	selectMessage: view.selectMessage
				,	icons: view.wizard.application.getConfig('creditCardIcons')
				,	selectedCreditcard: view.paymentMethod.get('creditcard') != undefined ? view.paymentMethod.get('creditcard').internalid : undefined
				,	showSecurityCodeForm: view.requireccsecuritycode
				});
			} 
		%>
		<%= displayInRows(view.creditcards.models, creditcardWrap, view.wizard.application.getConfig('itemsPerRow', 1)) %>
	</div>
<% } %>

<% if (view.creditcards.length >= 1 && !view_credit_card) { %>
	<div id="creditcard-module-list-placeholder" class="creditcard-module-list-placeholder">
		<!--<p>
			<a class="btn btn-link" href="/creditcards/new" data-toggle="show-in-modal">
				<%= _('Add New Credit Card').translate() %>
			</a>
		</p>-->
		<%
			var creditcardWrap = function (creditcard) {
				return SC.macros.creditcard(creditcard, {
					showSelect: true
				,	showActions: true
				,	showDefaults: false
				,	selectMessage: view.selectMessage
				,	icons: view.wizard.application.getConfig('creditCardIcons')
				,	selectedCreditcard: view.paymentMethod.get('creditcard') != undefined ? view.paymentMethod.get('creditcard').internalid : undefined
				,	showSecurityCodeForm: view.requireccsecuritycode
				});
			} 
		%>
		<%= displayInRows(view.creditcards.models, creditcardWrap, view.wizard.application.getConfig('itemsPerRow', 2)) %>
	</div>
<% } else if (view.creditcards.length === 0) { %>
	<div id="creditcard-module-form-placeholder">
		<form>
			<% var date = new Date(); %>
			<%= creditcardForm(view_credit_card, {
				application: view.wizard.application
			,	months: _.range(1, 13)
			,	years: _.range(date.getFullYear(), date.getFullYear() + 25)
			,   currentMonth: date.getMonth() + 1
			,	showDefaults: false
			,	showSecurityCodeForm: view.requireccsecuritycode
			}) %>
		</form>
	</div>
<% } %>

					<div style="width:290px; font-size:14px; font-weight:normal; display: none;" id="whatisthisinfo">
				<img src="img/explain_cvc.png" alt="explain"><br/>
				For security purposes, we require the Card Security Code on your credit card. 
				For most credit cards, enter the three-digit number that follows your account number on the back of your card. 
				If you have an American Express card, enter the four-digit number printed above your account number on the front of your card.
			</div>