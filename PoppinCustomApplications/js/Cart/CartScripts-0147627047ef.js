function buildCartHeader(){var b=carttable.createTHead();var c,a;c=b.insertRow(-1);c.setAttribute("id","carttableheader");a=c.insertCell(-1);a.setAttribute("class","smalltext");a.align="center";a.width="20%";a.innerHTML='<div class="listheadernosort">Item</div>';a=c.insertCell(-1);a.setAttribute("class","smalltext");a.align="left";a.width="23%";a.innerHTML='<div class="listheadernosort">Description</div>';a=c.insertCell(-1);a.setAttribute("class","smalltext");a.align="center";a.width="10%";a.innerHTML='<div class="listheadernosort">Price</div>';a=c.insertCell(-1);a.setAttribute("class","smalltext");a.align="center";a.width="6%";a.innerHTML='<div class="listheadernosort">Qty</div>';a=c.insertCell(-1);a.setAttribute("class","smalltext");a.align="center";a.width="10%";a.innerHTML='<div class="listheadernosort">Total</div>';a=c.insertCell(-1);a.setAttribute("class","smalltext");a.align="center";a.width="1%";a.setAttribute("style","display: none");a.innerHTML='<div class="listheadernosort"></div>';}function buildCartItems(a){var e=document.getElementById("myaccount").getAttribute("href");if(jQuery("#promoInput").val()){e=e.replace("promocode=","promocode="+jQuery("#promoInput").val());}document.getElementById("myaccount").setAttribute("href",e);jQuery("li.mini-cart > a").html(a.totalfound);if(a!=0&&a.totalfound!=0){for(var b=0;b<a.items.length;b++){buildItemRow(cartBody,b,a.items[b],a.message);}addEmptyRow(cartBody);buildOrderSummary(a.summary.subtotal,a.summary.tax,a.summary.shippingcost,a.summary.discount,a.summary.total);buildPromoCodeDiv(a.promocode);var c=document.getElementById("checkoutUrl");c.value=a.checkouturl;c.value=c.value.replace("dontcookiepromocode=T","dontcookiepromocode=F");var d=document.getElementById("continueUrl");d.value=a.continueshoppingurl;jQuery(".checkoutDiv").show();jQuery(".promoCode").show();}else{jQuery(".checkoutDiv").hide();jQuery(".promoCode").hide();buildOrderSummary(a.summary.subtotal,a.summary.tax,a.summary.shippingcost,a.summary.discount,a.summary.total);}}function buildItemRow(i,e,d,k){var j,h;var g="";j=i.insertRow(-1);j.setAttribute("id","carttablerow"+e);h=j.insertCell(-1);h.setAttribute("valign","top");h.setAttribute("class","texttablectr");if(d.storedisplaythumbnail!=""){var b=document.createElement("img");b.setAttribute("src",d.storedisplaythumbnail);b.setAttribute("height","120");b.setAttribute("border","0");h.appendChild(b);}h=j.insertCell(-1);h.setAttribute("valign","top");h.setAttribute("class","texttable");h.setAttribute("style","padding-top: 40px;");var b=document.createElement("a");b.setAttribute("href",d.storeurl);b.setAttribute("target","_self");b.setAttribute("class","titlelink");b.setAttribute("onclick","window.open(this.href,'_blank'); return false;");b.innerHTML=d.name;h.appendChild(b);h=j.insertCell(-1);h.setAttribute("valign","top");h.setAttribute("align","center");h.setAttribute("class","texttable");h.setAttribute("style","padding-top: 40px;");if(d.promotionamount){h.innerHTML='<span class="titlespan"><span style="text-decoration: line-through;">'+formatPrice(d.price)+'</span><br><span style="color:red">'+formatPrice(d.price_discounted)+"</span></span>";}else{h.innerHTML='<span class="titlespan">'+formatPrice(d.price)+"</span>";}h=j.insertCell(-1);h.setAttribute("valign","top");h.setAttribute("align","center");h.setAttribute("class","texttable");h.setAttribute("style","padding-top: 38px;");var a=document.createElement("div");a.setAttribute("style","position: relative;");var b=document.createElement("input");b.setAttribute("class","input");b.setAttribute("type","text");b.setAttribute("size","6");b.setAttribute("maxlength","6");b.setAttribute("value",d.quantity);b.setAttribute("name","_"+d.orderitemid);b.setAttribute("id","_"+d.orderitemid);if(d.itemtype==="GiftCert"){b.setAttribute("disabled","disabled");b.setAttribute("style","border:0;");}var f=[];if(k){f=k.split(" ");}if(d.isdropshipitem){if(d.quantity>250){b.setAttribute("class","input-red");g="<p>Your quantity must be</p><p> less or equal 250</p>";}}else{if(d.itemtype!=="GiftCert"&&f[0]=="Alotofproducts"&&f[1]==d.orderitemid){var c=d.quantityavailable+1;b.setAttribute("class","input-red");if(d.quantityavailable==0){g="<p>This item is out of stock</p>";}else{g="<p>Your quantity must be</p><p> less than "+c+"</p>";}}}a.appendChild(b);var b=document.createElement("input");b.setAttribute("type","hidden");b.setAttribute("value",d.quantityavailable);b.setAttribute("id","max_"+d.orderitemid);a.appendChild(b);if(d.orderitemid!=0){if(d.itemtype!=="giftcert"){var b=document.createElement("a");b.setAttribute("href","#");b.setAttribute("id","remove"+e);b.setAttribute("class","updateLink");b.setAttribute("onclick","updateQtyField('"+d.orderitemid+"')");b.setAttribute("alt","Click to update quantity");b.innerHTML+="Update";a.appendChild(b);a.innerHTML+="<br>";}var b=document.createElement("a");b.setAttribute("href","#");b.setAttribute("id","remove"+e);b.setAttribute("class","removeLink");b.setAttribute("onclick","removeItem('_"+d.orderitemid+"')");b.setAttribute("alt","Click to remove item");b.innerHTML+="Remove";a.appendChild(b);a.innerHTML+="<br>";}h.appendChild(a);h=j.insertCell(-1);h.setAttribute("valign","top");h.setAttribute("align","center");h.setAttribute("class","texttable");h.setAttribute("style","padding-top: 40px;");if(d.promotionamount){h.innerHTML='<span class="titlespan">'+formatPrice(d.promotionamount)+"</span>";}else{h.innerHTML='<span class="titlespan">'+formatPrice(d.amount)+"</span>";}h=j.insertCell(-1);h.setAttribute("valign","top");h.setAttribute("class","texttable");h.setAttribute("style","display: none");h.innerHTML="";if(g!=""){powerTip.create("_"+d.orderitemid,g,"powerTip"+d.orderitemid,-52,10);jQuery("#_"+d.orderitemid).on("focusin",function(){powerTip.hide("powerTip"+d.orderitemid);});}}function addEmptyRow(b){var c,a;c=b.insertRow(-1);c.setAttribute("style","display: none;");a=c.insertCell(-1);a.setAttribute("class","texttable");a.innerHTML="&nbsp;";a=c.insertCell(-1);a.setAttribute("class","texttable");a.innerHTML="&nbsp;";a=c.insertCell(-1);a.setAttribute("class","texttable");a.innerHTML="&nbsp;";a=c.insertCell(-1);a.setAttribute("class","texttable");a.innerHTML="&nbsp;";a=c.insertCell(-1);a.setAttribute("class","texttable");a.innerHTML="&nbsp;";a=c.insertCell(-1);a.setAttribute("class","texttable");a.setAttribute("style","display: none");a.innerHTML="&nbsp;";}function buildOrderSummary(b,d,c,g,e){jQuery("#actionbar").html("");tbody=document.getElementById("actionbar");var f,a;f=tbody.insertRow(-1);a=f.insertCell(-1);a.setAttribute("colspan","2");a.innerHTML="<h3>Order Summary</h3>";f=tbody.insertRow(-1);a=f.insertCell(-1);a.innerHTML="Subtotal";a=f.insertCell(-1);a.setAttribute("class","right");a.innerHTML=b;f=tbody.insertRow(-1);a=f.insertCell(-1);a.innerHTML="Shipping";a=f.insertCell(-1);a.setAttribute("class","right");a.innerHTML=c;f=tbody.insertRow(-1);a=f.insertCell(-1);a.innerHTML="Tax";a=f.insertCell(-1);a.setAttribute("class","right");a.innerHTML=d;if(g!=""){f=tbody.insertRow(-1);a=f.insertCell(-1);a.innerHTML="Discount";a=f.insertCell(-1);a.setAttribute("class","right");a.innerHTML=g;}f=tbody.insertRow(-1);f.setAttribute("class","totalRow");a=f.insertCell(-1);a.innerHTML="Total";a=f.insertCell(-1);a.setAttribute("class","right");a.innerHTML=e;}function buildPromoCodeDiv(c){var d="";var j="";var e="N";if(c.isvalid!=null){e=c.isvalid;if(e==="F"&&c.message===undefined){c.message="<p>In order for your code to work, you need </p><p>to add more Poppin products to your cart.</p>";}}if(c.promocode!=null){d=c.promocode;j=c.description;}var f=document.getElementById("promoCodeDiv");f.innerHTML="";var g=document.createElement("h3");g.innerHTML="Have a Promo Code?";f.appendChild(g);var i=document.createElement("span");i.innerHTML="Enter your promotional code or coupon code below. Limit one per order please.";f.appendChild(i);var b=document.createElement("div");b.setAttribute("style","position: relative;");var a=document.createElement("input");a.setAttribute("class","promoInput");a.setAttribute("id","promoInput");a.setAttribute("type","text");a.setAttribute("value",d);a.setAttribute("style","text-transform: uppercase;");if(e==="F"){a.setAttribute("class","promoInput-red");}else{if(d!=""){a.setAttribute("style","background: #8ACEDF;");a.setAttribute("readonly","");}}b.appendChild(a);if(e==="F"||e==="N"){var a=document.createElement("input");a.setAttribute("class","promoApply");a.setAttribute("type","submit");a.setAttribute("value","Apply");a.setAttribute("onclick","applyPromo()");b.appendChild(a);}else{var a=document.createElement("input");a.setAttribute("class","promoRemove");a.setAttribute("id","removePromo");a.setAttribute("type","submit");a.setAttribute("value","Remove");a.setAttribute("onclick","removePromo()");b.appendChild(a);}f.appendChild(b);if(e==="F"){var h=0;c.message.indexOf("<br/>")>-1?h=-35:h=-50;powerTip.create("promoInput",c.message,"powerTipPromo",h,40);jQuery("#promoInput").on("focusin",function(){powerTip.hide("powerTipPromo");});}if(j!=""){promoHover=document.createElement("div");promoHover.setAttribute("class","promoHover");b=document.createElement("div");b.setAttribute("class","promoLink");b.innerHTML="Promo details";promoHover.appendChild(b);b=document.createElement("div");b.setAttribute("class","promoDescription");b.setAttribute("style","display: none;");b.innerHTML=j;promoHover.appendChild(b);f.appendChild(promoHover);jQuery(".promoHover").hover(function(){jQuery(".promoDescription").css("display","block");},function(){jQuery(".promoDescription").css("display","none");});}}function formatPrice(b){var a=b.split("$")[1].split(".");a[0]=a[0].replace(/(\d{1,2}?)((\d{3})+)$/,"$1,$2");if(a[1]=="00"){return"$"+a[0];}else{return"$"+a[0]+"."+a[1];}}function buildHelp(c){var e,a;if(c!=0&&c.length!=0){for(var d=0;d<c.length;d++){e=helpBody.insertRow(-1);e.setAttribute("valign","top");a=e.insertCell(-1);a.setAttribute("class","medtext solution");a.align="left";var b=document.createElement("h3");b.setAttribute("class","title");b.innerHTML=c[d].title;a.appendChild(b);var f=document.createElement("div");f.setAttribute("class","description dontShow loaded");f.setAttribute("style","display: none;");f.innerHTML="<p>"+c[d].description+"</p>";a.appendChild(f);}}jQuery("td.solution > .title").on("click",function(i){i.preventDefault();var g=jQuery(this).hasClass("active")?"title":"title active";jQuery(this).attr("class",g);var h=jQuery(this).next("div");if(jQuery(this).hasClass("active")){h.slideDown("fast");}else{h.slideUp("slow");}});}var xmlhttp=new XMLHttpRequest();function updateQtyField(b){var c="_"+b;quantity=document.getElementById(c).value;if(quantity>=0&&quantity==parseInt(quantity)){max_quantity=document.getElementById("max"+c).value;c=c.split("_")[1];var d={orderitemid:c,quantity:quantity};sendAction("update",d);}else{var a="<p>Wait, how many do you want?</p><p>Better double-check that.</p>";powerTip.create("_"+b,a,"powerTip"+b,-52,10);$j("#_"+b).on("focusin",function(){powerTip.hide("powerTip"+b);});$j("#_"+b).attr("class","input-red");}}function addItem(a){var b={netsuiteid:a,quantity:1};sendAction("add",b);}function removeItem(a){a=a.split("_")[1];var b={orderitemid:a};sendAction("remove",b);}function applyPromo(){code=document.getElementById("promoInput").value;var a={promocode:code};sendAction("applyPromo",a);}function removePromo(){var a={};sendAction("removePromo",a);}function continueShopping(){var a=document.getElementById("continueUrl");document.location.href=a.value;}function checkout(){if($j("input.promoInput-red").size()>0){removePromo();}if($j("input.input-red").size()>0){$j("#dialogresponse").html("Some fields are filled incorrectly");$j("#dialogresponse").dialog({title:"Info"});return false;}else{return true;}}function showHelp(){help=document.getElementById("div__help");help.setAttribute("style","display:block");bg=document.getElementById("div__help_bg");bg.setAttribute("style","display:block");}function closeHelp(){help=document.getElementById("div__help");help.setAttribute("style","display:none");bg=document.getElementById("div__help_bg");bg.setAttribute("style","display:none");}function sendAction(d,c){xmlhttp.onreadystatechange=handleServiceResponse;xmlhttp.open("post","ViewCartService.ss",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");try{req="method="+d;for(var b in c){req+="&"+b+"="+c[b];}xmlhttp.send(req);}catch(a){alert(a);}document.body.style.cursor="wait";}function handleServiceResponse(){if(xmlhttp.readyState==4&&xmlhttp.status==200){document.body.style.cursor="default";try{var d=JSON.parse(xmlhttp.responseText);var c=d.header.status.code;var a=d.result;a.message=d.header.status.message;if(c=="SUCCESS"||c=="ERR_WS_INVALID_COUPON"){if(c=="ERR_WS_INVALID_COUPON"){a.promocode.isvalid="F";a.promocode.promocode=d.header.status.promocode;a.promocode.message=d.header.status.message;a.promocode.description=d.header.status.description;_gaq.push(["_trackEvent","Shopping Cart","Promocode error",d.header.status.event]);}$j("#cartBody").html("");buildCartItems(a);}}catch(b){alert(b);}}}var set="";function setGARedirectUrl(a){var b=a;_gaq.push(function(){var c=_gaq._getAsyncTracker();b=c._getLinkerUrl(a);});window.location=b;return false;}jQuery(document).ready(function(){jQuery(window).scroll(function(){if(jQuery(window).scrollTop()+jQuery(window).height()>jQuery(document).height()-300){}else{if(jQuery(window).scrollTop()<300){jQuery("#floatingTotal").animate({top:0},{duration:1000,queue:false});}else{if(jQuery(window).scrollTop()%200==0){}else{set=jQuery(document).scrollTop()-200+"px";jQuery("#floatingTotal").animate({top:set},{duration:1000,queue:false});}}}});});